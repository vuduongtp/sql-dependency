USE [CHUNGKHOAN]
GO
/****** Object:  Trigger [dbo].[TR_AfterInsert_LENHKHOP]    Script Date: 2020-05-11 7:00:24 PM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER TRIGGER  [dbo].[TR_AfterInsert_LENHKHOP] 
   ON  [dbo].[LENHKHOP] 
   AFTER INSERT 
AS 
BEGIN
	DECLARE @SOLUONGKHOP as INT = (SELECT SOLUONGKHOP FROM inserted) , @IDLENHDAT AS int = (SELECT IDLENHDAT FROM inserted), @GIAKHOP AS Float = (SELECT GIAKHOP FROM inserted)
	DECLARE @MACP AS NVARCHAR(7) = (SELECT MACP FROM LENHDAT WHERE LENHDAT.ID=@IDLENHDAT)

	UPDATE GIATRUCTUYEN SET KLKHOP = @SOLUONGKHOP,GIAKHOP= @GIAKHOP
	WHERE MACP=@MACP

END